Master base code.... to be merged.